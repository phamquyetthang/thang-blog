"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[8375],{19347:(e,a,n)=>{n.r(a),n.d(a,{assets:()=>d,contentTitle:()=>s,default:()=>h,frontMatter:()=>o,metadata:()=>r,toc:()=>c});var t=n(85893),i=n(11151);const o={title:"How to modify library in node module and save it forever",description:"Ways to Fix Errors in node_modules and Preserve Edits (Using patch-package, ...)",slug:"lam-cach-nao-de-sua-doi-thu-vien-trong-node-module",authors:["thang"],tags:["javascript","nodejs"],image:"https://images.viblo.asia/35468773-2fcb-4363-8ac0-52a6a00f2f07.jpg",hide_table_of_contents:!1},s=void 0,r={permalink:"/en/blog/lam-cach-nao-de-sua-doi-thu-vien-trong-node-module",source:"@site/i18n/en/docusaurus-plugin-content-blog/2023-12-22-sua-trong-node-module/index.md",title:"How to modify library in node module and save it forever",description:"Ways to Fix Errors in node_modules and Preserve Edits (Using patch-package, ...)",date:"2023-12-22T00:00:00.000Z",formattedDate:"December 22, 2023",tags:[{label:"javascript",permalink:"/en/blog/tags/javascript"},{label:"nodejs",permalink:"/en/blog/tags/nodejs"}],readingTime:2.295,hasTruncateMarker:!0,authors:[{name:"Ph\u1ea1m Quy\u1ebft Th\u1eafng",title:"Fullstack developer",url:"https://github.com/phamquyetthang",imageURL:"https://avatars.githubusercontent.com/u/43201625?s=400&u=9fa24ddfe492d15ba4692d4b295a5a2ef6b9ce24&v=4",key:"thang"}],frontMatter:{title:"How to modify library in node module and save it forever",description:"Ways to Fix Errors in node_modules and Preserve Edits (Using patch-package, ...)",slug:"lam-cach-nao-de-sua-doi-thu-vien-trong-node-module",authors:["thang"],tags:["javascript","nodejs"],image:"https://images.viblo.asia/35468773-2fcb-4363-8ac0-52a6a00f2f07.jpg",hide_table_of_contents:!1},unlisted:!1,prevItem:{title:"React - Uploading Images and Videos in React Quill using Cloudinary",permalink:"/en/blog/react-upload-anh-va-video-trong-rich-text-editor"}},d={authorsImageUrls:[void 0]},c=[{value:"1. When Fixing a Library from npm:",id:"1-when-fixing-a-library-from-npm",level:2},{value:"So, how can we fix libraries ourselves without losing changes if we delete the node_module?",id:"so-how-can-we-fix-libraries-ourselves-without-losing-changes-if-we-delete-the-node_module",level:3},{value:"2. Ways to Fix Libraries in node_modules",id:"2-ways-to-fix-libraries-in-node_modules",level:2},{value:"Approach 1: Fork the Package&#39;s Repo",id:"approach-1-fork-the-packages-repo",level:3},{value:"Approach 2: Use patch-package",id:"approach-2-use-patch-package",level:3},{value:"3. Demo:",id:"3-demo",level:2}];function l(e){const a={a:"a",code:"code",h2:"h2",h3:"h3",img:"img",p:"p",...(0,i.a)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(a.p,{children:"Ways to Fix Errors in node_modules and Preserve Edits (Using patch-package, ...)"}),"\n",(0,t.jsx)(a.h2,{id:"1-when-fixing-a-library-from-npm",children:"1. When Fixing a Library from npm:"}),"\n",(0,t.jsxs)(a.p,{children:["For JavaScript enthusiasts, installing third-party libraries using the command ",(0,t.jsx)(a.code,{children:"npm install <package name>"})," (or yarn) is a familiar routine."]}),"\n",(0,t.jsx)(a.p,{children:"After installation, these libraries reside in the node_modules directory, and we can easily use them."}),"\n",(0,t.jsx)(a.p,{children:(0,t.jsx)(a.img,{src:n(56021).Z+"",width:"486",height:"330"})}),"\n",(0,t.jsx)(a.p,{children:"What's inside the node_module is usually not something we need to know in detail. The node_module can sometimes be an untouchable area."}),"\n",(0,t.jsx)(a.p,{children:"Deleting the node_module and reinstalling is a spiritual solution many have used in desperation to fix bugs."}),"\n",(0,t.jsx)(a.p,{children:"Issues arise when we encounter a problem with a library but don't want to find an alternative."}),"\n",(0,t.jsx)(a.h3,{id:"so-how-can-we-fix-libraries-ourselves-without-losing-changes-if-we-delete-the-node_module",children:"So, how can we fix libraries ourselves without losing changes if we delete the node_module?"}),"\n",(0,t.jsx)(a.p,{children:"Here are some approaches:"}),"\n",(0,t.jsx)(a.h2,{id:"2-ways-to-fix-libraries-in-node_modules",children:"2. Ways to Fix Libraries in node_modules"}),"\n",(0,t.jsx)(a.h3,{id:"approach-1-fork-the-packages-repo",children:"Approach 1: Fork the Package's Repo"}),"\n",(0,t.jsx)(a.p,{children:"You can go to the source code of the package, fork it to your own Git repository, make changes, and then edit it."}),"\n",(0,t.jsxs)(a.p,{children:["Afterward, declare it in your package.json like this:\nFor example:\n",(0,t.jsx)(a.img,{alt:"image.png",src:n(75766).Z+"",width:"921",height:"110"})]}),"\n",(0,t.jsxs)(a.p,{children:["Replace the package version with the path to your repository in the format ",(0,t.jsx)(a.code,{children:"git+{repo}"}),"."]}),"\n",(0,t.jsx)(a.p,{children:"You may encounter some issues if you try to modify mega-packages like those from Facebook. Some packages are subdirectories of others."}),"\n",(0,t.jsxs)(a.p,{children:["You can go to ",(0,t.jsx)(a.a,{href:"https://gitpkg.vercel.app/",children:"https://gitpkg.vercel.app/"}),", paste the link directly to the directory containing that package. The website will render a link and yarn (npm) command for you."]}),"\n",(0,t.jsx)(a.p,{children:"(That's the theory, but whether it runs or not... To be sure, you can try approach 2.)"}),"\n",(0,t.jsx)(a.h3,{id:"approach-2-use-patch-package",children:"Approach 2: Use patch-package"}),"\n",(0,t.jsx)(a.p,{children:"This approach is more direct than the first one."}),"\n",(0,t.jsx)(a.p,{children:"Boldly find the code in your node_module that you want to edit and bravely make the changes."}),"\n",(0,t.jsx)(a.p,{children:"Then run the command:"}),"\n",(0,t.jsx)(a.p,{children:(0,t.jsx)(a.code,{children:"npx patch-package <package name>"})}),"\n",(0,t.jsx)(a.p,{children:"patch-package will create a patches folder, declaring your changes."}),"\n",(0,t.jsxs)(a.p,{children:["You can push this folder to Git and run the ",(0,t.jsx)(a.code,{children:"npx patch-package"})," command to reapply your changes."]}),"\n",(0,t.jsxs)(a.p,{children:["To avoid one step each time you reinstall the project, you can add the line ",(0,t.jsx)(a.code,{children:'"postinstall": "npx patch-package"'})," to the scripts like this to let node_module automatically render your changes every time you reinstall."]}),"\n",(0,t.jsx)(a.p,{children:(0,t.jsx)(a.img,{alt:"image.png",src:n(72914).Z+"",width:"431",height:"166"})}),"\n",(0,t.jsx)(a.h2,{id:"3-demo",children:"3. Demo:"}),"\n",(0,t.jsx)(a.p,{children:"I have a small demo."}),"\n",(0,t.jsx)(a.p,{children:"It involves changing the default logo of the metro in REACT-NATIVE."}),"\n",(0,t.jsx)(a.p,{children:"After some investigation, I found out it was written in a file named TerminalReporter.js in /node_modules/metro/src/lib."}),"\n",(0,t.jsx)(a.p,{children:"I thought there would be some complicated algorithms to print it out, like the C++ days at school, but no, it's just an array containing each line of #### :)))))"}),"\n",(0,t.jsx)(a.p,{children:"So, I just changed it."}),"\n",(0,t.jsx)(a.p,{children:"From:"}),"\n",(0,t.jsx)(a.p,{children:(0,t.jsx)(a.img,{alt:"image.png",src:n(31733).Z+"",width:"496",height:"532"})}),"\n",(0,t.jsx)(a.p,{children:"To:"}),"\n",(0,t.jsx)(a.p,{children:(0,t.jsx)(a.img,{alt:"image.png",src:n(52038).Z+"",width:"654",height:"636"})}),"\n",(0,t.jsx)(a.p,{children:"(I did it during the deadline days, too busy, so I decided to spend a day messing around to relieve stress after finishing.)"})]})}function h(e={}){const{wrapper:a}={...(0,i.a)(),...e.components};return a?(0,t.jsx)(a,{...e,children:(0,t.jsx)(l,{...e})}):l(e)}},75766:(e,a,n)=>{n.d(a,{Z:()=>t});const t=n.p+"assets/images/072ae723-f94b-4da3-9802-17bd928bfb57-6f9dbd8740f260951943790465efd645.png"},56021:(e,a,n)=>{n.d(a,{Z:()=>t});const t=n.p+"assets/images/35468773-2fcb-4363-8ac0-52a6a00f2f07-94562bf91bbf9f6c5a63587746110c78.jpg"},31733:(e,a,n)=>{n.d(a,{Z:()=>t});const t=n.p+"assets/images/6dffe6ba-b46f-43a1-a235-d30d12bf7cfa-8c69cefed3c002736512c6cfd98c4f2d.png"},52038:(e,a,n)=>{n.d(a,{Z:()=>t});const t=n.p+"assets/images/adef09a3-5890-477a-92af-7c5c4dbc7118-b3b116688e250d669456268feca9add1.png"},72914:(e,a,n)=>{n.d(a,{Z:()=>t});const t=n.p+"assets/images/ef048d12-b117-4597-8e6e-3de033978daa-69a4bf4f071055fbb4cc5767a106c30b.png"},11151:(e,a,n)=>{n.d(a,{Z:()=>r,a:()=>s});var t=n(67294);const i={},o=t.createContext(i);function s(e){const a=t.useContext(o);return t.useMemo((function(){return"function"==typeof e?e(a):{...a,...e}}),[a,e])}function r(e){let a;return a=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:s(e.components),t.createElement(o.Provider,{value:a},e.children)}}}]);