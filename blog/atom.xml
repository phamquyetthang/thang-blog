<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://phamquyetthang.github.io/blog</id>
    <title>Blog của Thắng Blog</title>
    <updated>2023-12-22T00:00:00.000Z</updated>
    <generator>https://github.com/jpmonette/feed</generator>
    <link rel="alternate" href="https://phamquyetthang.github.io/blog"/>
    <subtitle>Blog của Thắng Blog</subtitle>
    <icon>https://phamquyetthang.github.io/img/favicon.ico</icon>
    <entry>
        <title type="html"><![CDATA[React - Upload ảnh và video trong rich text editor]]></title>
        <id>https://phamquyetthang.github.io/blog/react-upload-anh-va-video-trong-rich-text-editor</id>
        <link href="https://phamquyetthang.github.io/blog/react-upload-anh-va-video-trong-rich-text-editor"/>
        <updated>2023-12-22T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Hướng dẫn sử dụng react-quill để làm richtext editor ( WYSIWYG ) và tích hợp Cloudinary để lưu trữ ảnh trong bài viết]]></summary>
        <content type="html"><![CDATA[<h3 class="anchor anchorWithStickyNavbar_LWe7" id="1giới-thiệu">1.Giới thiệu:<a href="https://phamquyetthang.github.io/blog/react-upload-anh-va-video-trong-rich-text-editor#1gi%E1%BB%9Bi-thi%E1%BB%87u" class="hash-link" aria-label="Đường dẫn trực tiếp tới 1.Giới thiệu:" title="Đường dẫn trực tiếp tới 1.Giới thiệu:">​</a></h3>
<p>Trong quá trình phát triển ứng dụng web hoặc trang blog, việc cung cấp một trình soạn thảo phong phú cho người dùng là một nhu cầu phổ biến. Điều này cho phép người dùng tạo, chỉnh sửa và định dạng nội dung của họ một cách linh hoạt và dễ dàng. Một trong những trình soạn thảo phổ biến trong cộng đồng lập trình là React Quill, với khả năng tùy chỉnh cao và dễ tích hợp vào dự án React của bạn.</p>
<p>Tuy nhiên, việc cho phép người dùng tải lên và chèn hình ảnh, video vào trình soạn thảo không phải là điều đơn giản. Đặc biệt khi bạn cần lưu trữ và quản lý hàng ngàn tệp đa phương tiện. Giải pháp là sử dụng dịch vụ lưu trữ hình ảnh đám mây mạnh mẽ như Cloudinary. Cloudinary cho phép bạn lưu trữ, tải lên, và quản lý hình ảnh, video một cách hiệu quả, giúp ứng dụng của bạn tăng cường tính năng và hiệu suất.</p>
<p>Trong bài viết này, chúng ta sẽ tìm hiểu cách tích hợp React Quill với dịch vụ lưu trữ hình ảnh Cloudinary để giải quyết vấn đề phức tạp này. Chúng ta sẽ cùng nhau xây dựng một trình soạn thảo cho phép người dùng tải lên và chèn hình ảnh, video một cách thuận tiện và nhanh chóng.</p>
<ul>
<li>React Quill: Là một trình soạn thảo mã nguồn mở cho phép người dùng tạo, chỉnh sửa nội dung với định dạng đa dạng.</li>
<li>Cloudinary: Dịch vụ lưu trữ đám mây mạnh mẽ hỗ trợ quản lý, tải lên, xử lý hình ảnh và video một cách dễ dàng.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="2-cài-đặt-react-quill">2. Cài đặt react-quill<a href="https://phamquyetthang.github.io/blog/react-upload-anh-va-video-trong-rich-text-editor#2-c%C3%A0i-%C4%91%E1%BA%B7t-react-quill" class="hash-link" aria-label="Đường dẫn trực tiếp tới 2. Cài đặt react-quill" title="Đường dẫn trực tiếp tới 2. Cài đặt react-quill">​</a></h3>
<ul>
<li>Đầu tiên chúng ta cần khởi tạo project react bằng vite hoặc create-react-app</li>
</ul>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">yarn create vite react-quill-upload --template react-ts</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Sao chép code vào bộ nhớ tạm" title="Sao chép" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li>Cài đặt react-quill :</li>
</ul>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">yarn add react-quill</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Sao chép code vào bộ nhớ tạm" title="Sao chép" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li>Import react-quill component:</li>
</ul>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">import React, { useState } from 'react';</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import ReactQuill from 'react-quill';</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import 'react-quill/dist/quill.snow.css';</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">function MyComponent() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  const [value, setValue] = useState('');</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  const reactQuillRef = useRef&lt;ReactQuill&gt;(null);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  return &lt;ReactQuill ref={reactQuillRef} theme="snow" value={value} onChange={setValue} /&gt;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Sao chép code vào bộ nhớ tạm" title="Sao chép" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li>Để upload image trong quill editor, chúng ta cần khai báo image vào phần module và formats</li>
</ul>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;ReactQuill</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      ref={reactQuillRef}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      theme="snow"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      placeholder="Start writing..."</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      modules={{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        toolbar: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          container: [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            [{ header: "1" }, { header: "2" }, { font: [] }],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            [{ size: [] }],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ["bold", "italic", "underline", "strike", "blockquote"],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              { list: "ordered" },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              { list: "bullet" },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              { indent: "-1" },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              { indent: "+1" },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ["link", "image", "video"],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ["code-block"],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ["clean"],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          ],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        clipboard: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          matchVisual: false,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      }}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      formats={[</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        "header",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        "font",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        "size",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        "bold",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        "italic",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        "underline",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        "strike",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        "blockquote",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        "list",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        "bullet",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        "indent",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        "link",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        "image",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        "video",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        "code-block",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      ]}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      value={value}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      onChange={onChange}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Sao chép code vào bộ nhớ tạm" title="Sao chép" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li>Lúc này bạn sẽ thấy icon upload image trên thanh công cụ của react-quill. Hãy import thử và in giá trị của toàn bộ văn bản ra, bạn sẽ thấy rằng mặc định react-quill sẽ lưu ảnh của bạn dưới dạng base-64:
<img loading="lazy" alt="image.png" src="https://phamquyetthang.github.io/assets/images/1-000bd2c41a54fbfbd240eeac53998ebe.webp" width="787" height="458" class="img_ev3q"></li>
</ul>
<blockquote>
<p>=&gt; nếu sử dụng theo cách mặc định này, chúng ta hoàn toàn có thể lưu trữ ảnh trong database dưới dạng base 64, trong demo mình chỉ sử dụng ảnh với kích thước nhỏ, nếu ảnh càng lớn string base-64 sẽ càng lớn, như thế sẽ rất tốn bộ nhớ.</p>
</blockquote>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="3-handle-upload-image">3. Handle upload image<a href="https://phamquyetthang.github.io/blog/react-upload-anh-va-video-trong-rich-text-editor#3-handle-upload-image" class="hash-link" aria-label="Đường dẫn trực tiếp tới 3. Handle upload image" title="Đường dẫn trực tiếp tới 3. Handle upload image">​</a></h3>
<ul>
<li>Để đỡ phải lưu chữ hình ảnh trong đoạn văn bản dưới dạng base-64, chúng ta cần tích hợp một clould service và chỉ cần lưu lại đường link của ảnh đó.Tiếp theo đây mình sẽ hướng dẫn các bạn handle hành động upload của react-quill và sử dụng cloudinary để lưu trữ nó ( các bạn có thể làm tương tự với một cloud bất kỳ nào khác, ví dụ firebase storage, ... )</li>
<li>Thêm imageHandler</li>
</ul>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> &lt;ReactQuill</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      ref={reactQuillRef}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      theme="snow"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      placeholder="Start writing..."</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      modules={{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        toolbar: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          container: [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">             ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ["link", "image", "video"],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ["code-block"],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ["clean"],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          ],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          handlers: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            image: imageHandler,   // &lt;- </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        clipboard: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          matchVisual: false,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      }}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Sao chép code vào bộ nhớ tạm" title="Sao chép" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  const imageHandler = useCallback(() =&gt; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    const input = document.createElement("input");</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    input.setAttribute("type", "file");</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    input.setAttribute("accept", "image/*");</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    input.click();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    input.onchange = async () =&gt; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      if (input !== null &amp;&amp; input.files !== null) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        const file = input.files[0];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        console.log(file)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }, []);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Sao chép code vào bộ nhớ tạm" title="Sao chép" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<blockquote>
<p>Giải thích : Ở đoạn code bên trên, mình viết thêm một hàm để handle container image của react-quill. Trong function imageHandler mình tạo ra một thẻ input file và gọi hàng click() để mở ra cửa sổ import file. Các bạn hoàn toàn có thể mở rộng phần này để mở lên upload widget của cloudinary ( <a href="https://cloudinary.com/documentation/react_image_and_video_upload" target="_blank" rel="noopener noreferrer">đọc thêm</a> ). <strong>Upload với widget sẽ bảo mật và tối ưu hơn do chúng ta có thể tái sử dụng những ảnh đã upload trước đó, nếu có thời gian và cần thiết, các bạn nên dùng cách đó !</strong></p>
</blockquote>
<ul>
<li>Function upload image lên cloudinary:
Có nhiều cách upload lên cloudinary, nhưng mình chọn cách dùng cách gọi api vì nó đơn giản nhất:</li>
</ul>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">const uploadToCloudinary = async (file: File): Promise&lt;string&gt; =&gt; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  const formData = new FormData();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  formData.append("file", file);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  formData.append(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    "upload_preset",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    import.meta.env.VITE_CLOUDINARY_PRESET</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  const res = await fetch(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    `https://api.cloudinary.com/v1_1/${</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      import.meta.env.VITE_CLOUDINARY_NAME</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }/upload`,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    { method: "POST", body: formData }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  const data = await res.json();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  const url = data.url;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  return url</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Sao chép code vào bộ nhớ tạm" title="Sao chép" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<blockquote>
<p>Giải thích: để upload ảnh lên cloudinary bằng api, các bạn cần có Product Name và upload_preset, các bạn có thể lấy từ trang setting của cloudinary ( bạn cần để mode của upload_preset là Unsigned, nếu muốn cách bảo mật hơn các bạn có thể dùng các cách upload khác của cloudinary )
<img loading="lazy" alt="image.png" src="https://phamquyetthang.github.io/assets/images/2-cce1e7ada738808e38789328c2666506.webp" width="825" height="502" class="img_ev3q"></p>
</blockquote>
<ul>
<li>Insert image url trả về từ cloudinary vào nội dung của đoạn văn bản</li>
</ul>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  const imageHandler = useCallback(() =&gt; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    const input = document.createElement("input");</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    input.setAttribute("type", "file");</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    input.setAttribute("accept", "image/*");</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    input.click();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    input.onchange = async () =&gt; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      if (input !== null &amp;&amp; input.files !== null) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        const file = input.files[0];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        const url = await uploadToCloudinary(file);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        const quill = reactQuillRef.current;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (quill) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          const range = quill.getEditorSelection();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          range &amp;&amp; quill.getEditor().insertEmbed(range.index, "image", url);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }, []);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Sao chép code vào bộ nhớ tạm" title="Sao chép" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<blockquote>
<p>Giải thích: Sau khi có được url từ việc upload lên cloudinary, chúng ta cần gán nó vào đúng vị trí của thẻ img tương ứng trong đoạn văn bản:</p>
</blockquote>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">const range = quill.getEditorSelection();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">range &amp;&amp; quill.getEditor().insertEmbed(range.index, "image", url);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Sao chép code vào bộ nhớ tạm" title="Sao chép" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<blockquote>
<p>Phần này chính là để xác định vị trí của thẻ img và gán nó với url trả về từ cloudinary ( trước đó hãy dùng useRef để tham chiếu đến ReactQuill component )</p>
</blockquote>
<ul>
<li>Và đây là kết quả, lúc này nội dung văn bản chỉ còn chứa đường link của ảnh thay vì base-64:
<img loading="lazy" alt="image.png" src="data:image/webp;base64,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" width="825" height="349" class="img_ev3q"></li>
</ul>
<p>Toàn bộ source code có thể xem ở: <a href="https://github.com/phamquyetthang/react-quill-image-upload" target="_blank" rel="noopener noreferrer">https://github.com/phamquyetthang/react-quill-image-upload</a></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="4-kết-luận">4. Kết luận<a href="https://phamquyetthang.github.io/blog/react-upload-anh-va-video-trong-rich-text-editor#4-k%E1%BA%BFt-lu%E1%BA%ADn" class="hash-link" aria-label="Đường dẫn trực tiếp tới 4. Kết luận" title="Đường dẫn trực tiếp tới 4. Kết luận">​</a></h3>
<p>Trên đây là hướng dẫn đơn giản của mình để handle việc upload hình ảnh trong react-quill, các bạn có thể làm điều tương tự với việc upload video!</p>
<p>Các bạn có thể xem toàn bộ code của phần hướng dẫn trên trong github của mình: <a href="https://github.com/phamquyetthang/react-quill-image-upload" target="_blank" rel="noopener noreferrer">https://github.com/phamquyetthang/react-quill-image-upload</a></p>
<p>Hy vọng bài viết này hữu ích với bạn. Cảm ơn bạn đã đọc!</p>
<p>Nếu có bất kỳ câu hỏi hoặc ý kiến gì, hãy để lại bình luận bên dưới. Chúng ta có thể cùng nhau thảo luận về chủ đề này.</p>]]></content>
        <author>
            <name>Phạm Quyết Thắng</name>
            <uri>https://github.com/phamquyetthang</uri>
        </author>
        <category label="react" term="react"/>
        <category label="javascript" term="javascript"/>
        <category label="nodejs" term="nodejs"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Làm cách nào để sửa đổi thư viện trong node module]]></title>
        <id>https://phamquyetthang.github.io/blog/lam-cach-nao-de-sua-doi-thu-vien-trong-node-module</id>
        <link href="https://phamquyetthang.github.io/blog/lam-cach-nao-de-sua-doi-thu-vien-trong-node-module"/>
        <updated>2023-12-22T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Một vài cách để fix lỗi trong node_module và lưu lại chỉnh sửa đó ( dùng patch-package, ... )]]></summary>
        <content type="html"><![CDATA[<p>Một vài cách để fix lỗi trong node_module và lưu lại chỉnh sửa đó ( dùng patch-package, ... )</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="1-khi-cần-fix-thư-viện-từ-npm">1. Khi cần fix thư viện từ npm:<a href="https://phamquyetthang.github.io/blog/lam-cach-nao-de-sua-doi-thu-vien-trong-node-module#1-khi-c%E1%BA%A7n-fix-th%C6%B0-vi%E1%BB%87n-t%E1%BB%AB-npm" class="hash-link" aria-label="Đường dẫn trực tiếp tới 1. Khi cần fix thư viện từ npm:" title="Đường dẫn trực tiếp tới 1. Khi cần fix thư viện từ npm:">​</a></h2>
<p>Đối với các anh em người chơi hệ js , thì chắc đều không lạ lẫm gì với việc cài đặt các thư viện của bên thứ ba qua câu lệnh
<code>npm install &lt;package name&gt;</code> ( hoặc yarn )</p>
<p>Các thư viện này sau khi được cài đặt sẽ nằm trong node module và tôi và các bạn chỉ việc lấy ra sử dụng.</p>
<p><img loading="lazy" src="https://phamquyetthang.github.io/assets/images/35468773-2fcb-4363-8ac0-52a6a00f2f07-94562bf91bbf9f6c5a63587746110c78.jpg" width="486" height="330" class="img_ev3q"></p>
<p>Những gì có trong node_module chúng ta không cần thiết phải biết gồm những gì.</p>
<p>Node_module có khi còn là vùng cấm không ai muốn đụng vào.</p>
<p>Xóa node_module và cài lại cũng là 1 trong những giải pháp tâm linh chắc chắn bạn từng sử dụng để fix bug trong tuyệt vong.</p>
<p>Vấn đề phát sinh khi chúng ta phát hiện 1 issues của thư viện không như chúng ta mong muốn nhưng không muốn tìm thư viện khác để thay thế.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="vậy-làm-cách-nào-để-tự-mình-sửa-thư-viện-và-không-bị-mất-đi-nếu-xóa-node_module">Vậy làm cách nào để tự mình sửa thư viện và không bị mất đi nếu xóa node_module<a href="https://phamquyetthang.github.io/blog/lam-cach-nao-de-sua-doi-thu-vien-trong-node-module#v%E1%BA%ADy-l%C3%A0m-c%C3%A1ch-n%C3%A0o-%C4%91%E1%BB%83-t%E1%BB%B1-m%C3%ACnh-s%E1%BB%ADa-th%C6%B0-vi%E1%BB%87n-v%C3%A0-kh%C3%B4ng-b%E1%BB%8B-m%E1%BA%A5t-%C4%91i-n%E1%BA%BFu-x%C3%B3a-node_module" class="hash-link" aria-label="Đường dẫn trực tiếp tới Vậy làm cách nào để tự mình sửa thư viện và không bị mất đi nếu xóa node_module" title="Đường dẫn trực tiếp tới Vậy làm cách nào để tự mình sửa thư viện và không bị mất đi nếu xóa node_module">​</a></h3>
<p>Chúng ta có những cách sau đây:</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="2các-cách-sửa-thư-viện-trong-node_modules">2.Các cách sửa thư viện trong node_modules<a href="https://phamquyetthang.github.io/blog/lam-cach-nao-de-sua-doi-thu-vien-trong-node-module#2c%C3%A1c-c%C3%A1ch-s%E1%BB%ADa-th%C6%B0-vi%E1%BB%87n-trong-node_modules" class="hash-link" aria-label="Đường dẫn trực tiếp tới 2.Các cách sửa thư viện trong node_modules" title="Đường dẫn trực tiếp tới 2.Các cách sửa thư viện trong node_modules">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="cách-1-fork-repo-của-package">Cách 1: Fork repo của package<a href="https://phamquyetthang.github.io/blog/lam-cach-nao-de-sua-doi-thu-vien-trong-node-module#c%C3%A1ch-1-fork-repo-c%E1%BB%A7a-package" class="hash-link" aria-label="Đường dẫn trực tiếp tới Cách 1: Fork repo của package" title="Đường dẫn trực tiếp tới Cách 1: Fork repo của package">​</a></h3>
<p>Bạn có thể vào source code của package đó, fork về git của mình một bản , sửa đổi nó sau đó sửa.</p>
<p>Sau đó khai báo nó vào trong package.json:
Ví dụ như này
<img loading="lazy" alt="image.png" src="https://phamquyetthang.github.io/assets/images/072ae723-f94b-4da3-9802-17bd928bfb57-6f9dbd8740f260951943790465efd645.png" width="921" height="110" class="img_ev3q"></p>
<p>Thay số phiên bản của package bằng đường dẫn đến repo của bạn theo dạng <code>git+{repo}</code></p>
<p>Đến đây bạn có thể sẽ gặp một số vấn đề nếu cố sửa đổi các package siêu to khổng lồ như mấy cái của facebook, có vài package lại là thư mục con của 1 package khác.</p>
<p>Bạn có thể vào trang <a href="https://gitpkg.vercel.app/" target="_blank" rel="noopener noreferrer">https://gitpkg.vercel.app/</a> , dán đường link trực tiếp đến thư mục chứa package đó . Trang web này sẽ render cho bạn 1 đường link và cả câu lệnh yarn ( npm ).</p>
<p>(Lý thuyết là thế, nhưng nó có chạy hay không thì, ..., để chắc kèo thì mọi người có thể chơi cách 2 )</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="cách-2-sử-dụng-patch-package">Cách 2: Sử dụng patch-package<a href="https://phamquyetthang.github.io/blog/lam-cach-nao-de-sua-doi-thu-vien-trong-node-module#c%C3%A1ch-2-s%E1%BB%AD-d%E1%BB%A5ng-patch-package" class="hash-link" aria-label="Đường dẫn trực tiếp tới Cách 2: Sử dụng patch-package" title="Đường dẫn trực tiếp tới Cách 2: Sử dụng patch-package">​</a></h3>
<p>Cách này trực tiếp hơn cách thứ nhất,</p>
<p>Bạn cứ mạnh dạn tìm đến chỗ code trong node_module bạn định sửa và mạnh dạn sửa nó.</p>
<p>Sau đó chạy câu lệnh:</p>
<p><code> npx patch-package &lt;package name&gt;</code></p>
<p>patch-package sau đó sẽ tạo một thư mục patches, khai báo về các thay đổi của bạn.</p>
<p>Bạn có thể push folder này lên git và chạy lệnh <code>npx patch-package</code> để render lại những thay đổi của bạn.</p>
<p>Để đỡ mất một bước mỗi khi install lại project, bạn có thể thêm dòng <code>"postinstall": "npx patch-package"</code> vào script như thế này để node_module tự render theo thay đổi của bạn mỗi khi install lại .</p>
<p><img loading="lazy" alt="image.png" src="https://phamquyetthang.github.io/assets/images/ef048d12-b117-4597-8e6e-3de033978daa-69a4bf4f071055fbb4cc5767a106c30b.png" width="431" height="166" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="3-demo">3. Demo:<a href="https://phamquyetthang.github.io/blog/lam-cach-nao-de-sua-doi-thu-vien-trong-node-module#3-demo" class="hash-link" aria-label="Đường dẫn trực tiếp tới 3. Demo:" title="Đường dẫn trực tiếp tới 3. Demo:">​</a></h2>
<p>Mình có một demo nho nhỏ .</p>
<p>Đó là đổi cái cái logo mặc định của thằng metro trong REACT-NATIVE,
sau 1 hồi lục lọi mình phát hiện ra cái đống ấy viết ở một file tên TerminalReporter.js trong /node_modules/metro/src/lib</p>
<p>Tưởng là sẽ có mấy hàm thuật toán loằng ngoằng để in ra như hồi học C++ ở trường, nhưng không, nó chỉ là cái mảng chứ từng dòng dấu #### một :)))))
Thế thì dễ rồi, mình cứ thế mà đổi lại thôi.</p>
<p>Từ:</p>
<p><img loading="lazy" alt="image.png" src="https://phamquyetthang.github.io/assets/images/6dffe6ba-b46f-43a1-a235-d30d12bf7cfa-8c69cefed3c002736512c6cfd98c4f2d.png" width="496" height="532" class="img_ev3q"></p>
<p>Thành:</p>
<p><img loading="lazy" alt="image.png" src="https://phamquyetthang.github.io/assets/images/adef09a3-5890-477a-92af-7c5c4dbc7118-b3b116688e250d669456268feca9add1.png" width="654" height="636" class="img_ev3q"></p>
<p>( Mình làm trong những ngày deadline dí tận cổ, bận quá nên mình quyết định nằm nghịch hết 1 ngày cho đỡ khủng hoảng, nghịch xong stress hơn )</p>]]></content>
        <author>
            <name>Phạm Quyết Thắng</name>
            <uri>https://github.com/phamquyetthang</uri>
        </author>
        <category label="javascript" term="javascript"/>
        <category label="nodejs" term="nodejs"/>
    </entry>
</feed>